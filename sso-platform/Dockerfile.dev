# syntax=docker/dockerfile:1
# =============================================================================
# SSO Platform - Development Dockerfile
# =============================================================================
# Hot reload with pnpm dev + polling for Docker volume mounts
# =============================================================================

FROM node:22-alpine

WORKDIR /app

# Enable corepack for pnpm
RUN corepack enable && corepack prepare pnpm@latest --activate

# Install dependencies first (cached layer)
COPY package.json pnpm-lock.yaml ./
RUN pnpm install --frozen-lockfile

# Polling for macOS Docker volume mounts
ENV WATCHPACK_POLLING=true
ENV CHOKIDAR_USEPOLLING=true
ENV NODE_ENV=development

EXPOSE 3001

# Hot reload command
CMD ["pnpm", "dev"]
